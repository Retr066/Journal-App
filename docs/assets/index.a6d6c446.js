var W=Object.defineProperty,$=Object.defineProperties;var q=Object.getOwnPropertyDescriptors;var P=Object.getOwnPropertySymbols;var V=Object.prototype.hasOwnProperty,J=Object.prototype.propertyIsEnumerable;var x=(e,t,o)=>t in e?W(e,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[t]=o,d=(e,t)=>{for(var o in t||(t={}))V.call(t,o)&&x(e,o,t[o]);if(P)for(var o of P(t))J.call(t,o)&&x(e,o,t[o]);return e},m=(e,t)=>$(e,q(t));import{i as K,d as Q,G as X,S as _,q as H,n as j,a as A,W as Y,z as Z,Q as ee,g as b,s as te,b as ae,c as ne,e as oe,u as se,r as h,f as p,h as f,j as l,k as a,l as re,T as ie,F as le,m as F,o as g,L as U,v as D,w as ce,p as O,R as T,t as y,N as C,x as de,H as ue,y as me,A as he,B as pe,C as fe,D as ge,P as _e,E as ye,I as Ne}from"./vendor.0e52ea8b.js";const we=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))i(n);new MutationObserver(n=>{for(const s of n)if(s.type==="childList")for(const r of s.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&i(r)}).observe(document,{childList:!0,subtree:!0});function o(n){const s={};return n.integrity&&(s.integrity=n.integrity),n.referrerpolicy&&(s.referrerPolicy=n.referrerpolicy),n.crossorigin==="use-credentials"?s.credentials="include":n.crossorigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(n){if(n.ep)return;n.ep=!0;const s=o(n);fetch(n.href,s)}};we();var w=(e=>(e.login="[Auth] Login",e.logout="[Auth] Logout",e))(w||{}),v=(e=>(e.uiStartLoading="[UI] start loading",e.uiFinishLoading="[UI] Finish loading",e))(v||{}),u=(e=>(e.notesAddNew="[Notes] New note",e.notesActive="[Notes] Set active note",e.notesLoad="[Notes] Load note",e.notesUpdated="[Notes] Update note",e.notesFileUrl="[Notes] Update image url",e.notesDelete="[Notes] Delete note",e.notesLogoutCleaning="[Notes] Logout Cleaning",e))(u||{});const ve={apiKey:"AIzaSyAUIUzA51QHk4GhgSMdL_oYw2zepXihKiM",authDomain:"journal-app-bac9d.firebaseapp.com",projectId:"journal-app-bac9d",storageBucket:"journal-app-bac9d.appspot.com",messagingSenderId:"1066675860273",appId:"1:1066675860273:web:a68fdbc488e74e86f4f610"};K(ve);const k=Q(),be=new X,B=()=>({type:v.uiStartLoading}),S=()=>({type:v.uiFinishLoading}),N=_.mixin({toast:!0,position:"top-end",showConfirmButton:!1,timer:3e3,timerProgressBar:!0,didOpen:e=>{e.addEventListener("mouseenter",_.stopTimer),e.addEventListener("mouseleave",_.resumeTimer)}}),Le=e=>{const t="https://api.cloudinary.com/v1_1/duaj7oxcq/upload",o=new FormData;return o.append("upload_preset","react_journal"),o.append("file",e),new Promise(function(i,n){fetch(t,{method:"POST",body:o}).then(s=>{if(s.ok)return s.json()}).then(s=>i(s.secure_url)).catch(s=>n(s))})},Se=e=>new Promise(function(t){H(j(k,`${e}/journal/notes/`)).then(o=>{const i=[];o.forEach(n=>{const{title:s,date:r,body:c,imaUrl:L}=n.data();i.push({id:n.id,title:s,date:r,body:c,imaUrl:L})}),t(i)}).catch(o=>{throw new Error("Algo salio mal en llamar todos las notes:"+o)})}),Ce=()=>(e,t)=>{const{uid:o}=t().auth,i={title:"",body:"",date:new Date().getTime()};Z(j(k,`${o}/journal/notes`),i).then(n=>{e(I(n.id,i)),e(ke(n.id,i))})},I=(e,t)=>({type:u.notesActive,payload:d({id:e},t)}),ke=(e,t)=>({type:u.notesAddNew,payload:d({id:e},t)}),Ee=e=>t=>{Se(e).then(o=>t(Ie(o)))},Ie=e=>({type:u.notesLoad,payload:e}),M=e=>(t,o)=>{const{uid:i}=o().auth;e.imaUrl||delete e.imaUrl;const n=d({},e);delete n.id;const s=A(k,`${i}/journal/notes/${e.id}`);ee(s,n).then(()=>{e.id&&t(Pe(e)),N.fire({icon:"success",title:"Saved: "+e.title})}).catch(r=>{N.fire({icon:"error",title:"Error: "+r.message})})},Pe=e=>({type:u.notesUpdated,payload:e}),xe=e=>(t,o)=>{const{active:i}=o().notes;_.fire({title:"Uploading....",text:"Please wait...",allowOutsideClick:!0,timerProgressBar:!0,backdrop:!0,showConfirmButton:!1,willOpen:()=>{_.showLoading()}}),Le(e).then(n=>{typeof n=="string"&&(i.imaUrl=n),t(M(i)),_.close()}).catch(n=>{throw n})},Re=e=>(t,o)=>{const{uid:i}=o().auth,n=A(k,`${i}/journal/notes/${e}`);Y(n).then(()=>t(je(e)))},je=e=>({type:u.notesDelete,payload:e}),Ae=()=>({type:u.notesLogoutCleaning}),E=(e,t)=>({type:w.login,payload:{uid:e,displayName:t}}),Fe=()=>e=>{const t=b();ne(t,be).then(({user:o})=>{e(E(o.uid,o.displayName))}).catch(o=>console.error(o))},Ue=(e,t)=>o=>{o(B());const i=b();ae(i,e,t).then(({user:n})=>{o(E(n.uid,n.displayName)),o(S())}).catch(n=>{const s=n.code,r=n.message;o(S()),s==="auth/user-not-found"?N.fire({icon:"error",title:"User not found"}):N.fire({icon:"error",title:r})})},De=(e,t,o)=>i=>{const n=b();i(B()),oe(n,e,t).then(async({user:s})=>{n.currentUser!==null&&(await se(n.currentUser,{displayName:o}),i(E(s.uid,s.displayName)),i(S()))}).catch(s=>{const r=s.code,c=s.message;i(S()),r==="auth/email-already-in-use"?N.fire({icon:"error",title:"Email already in use"}):N.fire({icon:"error",title:c})})},Oe=()=>async e=>{const t=b();await te(t),e(Te()),e(Ae())},Te=()=>({type:w.logout});function Be(e){const[t,o]=h.exports.useState(e);return{values:t,handleInputsChange:({target:s})=>{o(m(d({},t),{[s.name]:s.value}))},resetState:(s=e)=>{o(s)}}}const Me=()=>{const e=p(),{active:t}=f(s=>s.notes);return l("div",{className:"notes_appbar",children:[a("span",{children:"28 de agosto 2022"}),a("input",{type:"file",id:"fileSelector",name:"file",style:{display:"none"},onChange:s=>{const r=s.target.files[0];e(xe(r))}}),l("div",{children:[a("button",{className:"btn btn-black",onClick:s=>{var r;(r=document.getElementById("fileSelector"))==null||r.click()},children:"Picture"}),a("button",{className:"btn btn-black",onClick:()=>{e(M(t))},children:"Save"})]})]})},ze=()=>{const{active:e}=f(G=>G.notes),{values:t,handleInputsChange:o,resetState:i}=Be(e),n=p(),{title:s,body:r,id:c}=t,L=h.exports.useRef(e.id);h.exports.useEffect(()=>{e.id!==L.current&&(i(e),L.current=e.id)},[e,i]),h.exports.useEffect(()=>{c&&n(I(c,d({},t)))},[t]);const z=()=>{c&&n(Re(c))};return l("div",{className:"notes__main-content",children:[a(Me,{}),l("div",{className:"notes__content",children:[a("input",{autoComplete:"off",type:"text",name:"title",placeholder:"Some awesome title",className:"notes__title-input",value:s,onChange:o}),a("textarea",{placeholder:"What happened today",className:"notes__textarea",name:"body",value:r,onChange:o}),e.imaUrl&&a("div",{className:"notes_image",children:a("img",{alt:"imagen",src:e.imaUrl})})]}),a("div",{className:"btn btn-danger",onClick:z,children:"Delete"})]})},Ge=()=>l("div",{className:"nothing__main-content",children:[l("p",{children:["Select something",a("br",{}),"pr create an entry!"]}),a("i",{className:"far fa-star fa-4x mt-5"})]}),We=({id:e,title:t,body:o,date:i,imaUrl:n})=>{const s=re(i),r=p();return l("div",{className:"journal__entry animate__animated animate__fadeInDown animate__faster",onClick:()=>{e!==void 0&&r(I(e,{title:t,body:o,date:i,imaUrl:n}))},children:[n&&a("div",{className:"journal__entry-picture",style:{backgroundSize:"cover",backgroundImage:`url(${n})`}}),l("div",{className:"journal__entry-body",children:[a("p",{className:"journal__entry-title",children:t}),a("p",{className:"journal__entry-content",children:o})]}),l("div",{className:"journal__entry-date-box",children:[a("span",{children:s.format("dddd")}),l("h4",{children:[s.format("Do")," "]})]})]})},$e=()=>{const{notes:e}=f(t=>t.notes);return a("div",{className:"journal__entries ",children:e.map(t=>a(We,d({},t),t.id))})},qe=()=>{const e=p(),{name:t}=f(n=>n.auth);return l("aside",{className:"journal__sidebar",children:[l("div",{className:"journal__sidebar-navbar",children:[l("h3",{className:"mt-5",children:[a("i",{className:"far fa-moon"}),a("span",{children:t})]}),a("button",{type:"button",onClick:()=>{e(Oe())},className:"btn btn-black",children:"Logout"})]}),l("div",{className:"journal__new-entry",onClick:()=>{e(Ce())},children:[a("i",{className:"far fa-calendar-plus fa-5x"}),a("p",{className:"mt-5",children:"New Entry"})]}),a($e,{})]})};function Ve(){const{active:e}=f(t=>t.notes);return l("div",{className:"journal__main-content animate__animated animate__fadeIn animate__faster",children:[a(qe,{}),a("main",{children:e?a(ze,{}):a(Ge,{})})]})}const Je=()=>l("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",flexDirection:"column",height:"100vh"},className:"animate__animated animate__fadeIn ",children:[a("div",{style:{backgroundSize:"cover",backgroundImage:"url(https://res.cloudinary.com/dsulcam/image/upload/v1624776603/skueresoft_qoczsy.png)",width:"570px",height:"400px"}}),a(ie,{color:"black",ariaLabel:"loading-indicator"})]}),Ke=()=>{const e=p(),{loading:t}=f(r=>r.ui),o={email:"",password:""},i=r=>{let c={};return D.isEmail(r.email)?r.password.length<5&&(c.password="Password should be at least 6 characters"):c.email="Invalid email address",c},n=({email:r,password:c})=>{e(Ue(r,c))},s=()=>{e(Fe())};return l("div",{className:"animate__animated animate__fadeIn animate__faster",children:[a("h3",{className:"auth__title",children:"Login By Retr0 \u{1F60E}"}),a("hr",{}),a(le,{initialValues:o,validate:i,onSubmit:n,children:({errors:r,touched:c})=>l(F,{children:[a(g,{type:"text",placeholder:"Email",name:"email",className:"auth__input",autoComplete:"new-off"}),c.email&&r.email&&a("div",{className:"auth__alert-error",children:r.email}),a(g,{type:"password",placeholder:"Password",name:"password",className:"auth__input",autoComplete:"off"}),c.email&&r.password&&a("div",{className:"auth__alert-error",children:r.password}),a("button",{type:"submit",className:"btn btn-primary btn-block",disabled:t,children:"Login"}),l("div",{className:"auth__social-networks",children:[a("p",{children:"Login with social networks"}),l("div",{className:"google-btn",onClick:s,children:[a("div",{className:"google-icon-wrapper",children:a("img",{className:"google-icon",src:"https://upload.wikimedia.org/wikipedia/commons/5/53/Google_%22G%22_Logo.svg",alt:"google button"})}),a("p",{className:"btn-text",children:a("b",{children:"Sign in with google"})})]})]}),a(U,{to:"/auth/register",className:"link",children:"Create new account"})]})})]})},Qe=()=>{const e=p(),{loading:t}=f(n=>n.ui),o=n=>{const{touched:s,errors:r,message:c}=n;return l("div",{className:"animate__animated animate__fadeIn animate__faster",children:[a("h3",{className:"auth__title",children:c}),a("hr",{}),l(F,{children:[a(g,{type:"text",placeholder:"Full name",name:"full_name",className:"auth__input",autoComplete:"new-off"}),s.email&&r.full_name&&a("div",{className:"auth__alert-error",children:r.full_name}),a(g,{type:"email",placeholder:"Email",name:"email",className:"auth__input",autoComplete:"new-off"}),s.email&&r.email&&a("div",{className:"auth__alert-error",children:r.email}),a(g,{type:"password",placeholder:"Password",name:"password",className:"auth__input",autoComplete:"off"}),s.password&&r.password&&a("div",{className:"auth__alert-error",children:r.password}),a(g,{type:"password",placeholder:"Confirm password",name:"password_confirm",className:"auth__input",autoComplete:"off"}),s.password_confirm&&r.password_confirm&&a("div",{className:"auth__alert-error",children:r.password_confirm}),a("button",{type:"submit",className:"btn btn-primary btn-block",disabled:t,children:"Register"}),a(U,{to:"/auth/login",className:"link mt-5",children:"Alredy Register?"})]})]})},i=ce({mapPropsToValues:()=>({full_name:"",email:"",password:"",password_confirm:""}),validate:n=>{let s={};return n.full_name?D.isEmail(n.email)?n.password!==n.password_confirm?s.password_confirm="Password  match each other":n.password.length<5&&(s.password="Password should be at least 6 characters"):s.email="Invalid email address":s.full_name="Required",s},handleSubmit:({email:n,password:s,full_name:r})=>{e(De(n,s,r))}})(o);return a(O,{children:a(i,{message:"Register By Retr0 \u{1F60E}"})})},Xe=()=>a("div",{className:"auth__main",children:a("div",{className:"auth__box-container",children:l(T,{children:[a(y,{path:"login",element:a(Ke,{})}),a(y,{path:"register",element:a(Qe,{})}),a(y,{path:"*",element:a(C,{replace:!0,to:"login"})})]})})}),He=({isAuth:e,children:t})=>e?t:a(C,{to:"/auth/login"}),Ye=({isAuth:e,children:t})=>e?a(C,{to:"/"}):t;function Ze(){const e=p(),[t,o]=h.exports.useState(!0),[i,n]=h.exports.useState(!1);return h.exports.useEffect(()=>{const s=b();de(s,r=>{(r==null?void 0:r.uid)?(e(E(r.uid,r.displayName)),n(!0),e(Ee(r.uid))):n(!1),setTimeout(()=>{o(!1)},1e3)})},[e]),t?a(Je,{}):a(O,{children:a(ue,{children:l(T,{children:[a(y,{path:"auth/*",element:a(Ye,{isAuth:i,children:a(Xe,{})})}),a(y,{path:"/",element:a(He,{isAuth:i,children:a(Ve,{})})}),a(y,{path:"*",element:a(C,{replace:!0,to:"auth"})})]})})})}const et=(e={},t)=>{switch(t.type){case w.login:return{uid:t.payload.uid,name:t.payload.displayName};case w.logout:return{};default:return e}},tt=(e={loading:!1,msgError:null},t)=>{switch(t.type){case v.uiStartLoading:return m(d({},e),{loading:!0});case v.uiFinishLoading:return m(d({},e),{loading:!1});default:return e}},R={notes:[],active:null},at=(e=R,t)=>{switch(t.type){case u.notesActive:return m(d({},e),{active:d({},t.payload)});case u.notesAddNew:return m(d({},e),{notes:[t.payload,...e.notes]});case u.notesLoad:return m(d({},e),{notes:t.payload});case u.notesUpdated:return m(d({},e),{notes:e.notes.map(o=>{if("id"in t.payload)return o.id===t.payload.id?t.payload:o})});case u.notesDelete:return m(d({},e),{active:null,notes:e.notes.filter(o=>{if(typeof t.payload=="string")return o.id!==t.payload})});case u.notesLogoutCleaning:return R;default:return e}},nt=me({auth:et,ui:tt,notes:at}),ot=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||fe,st=he(nt,ot(pe(ge)));function rt(){return a(_e,{store:st,children:a(Ze,{})})}ye.render(a(Ne.StrictMode,{children:a(rt,{})}),document.getElementById("root"));
